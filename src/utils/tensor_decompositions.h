#pragma once

#include "../core/tensor.h"

// Some known tensor decompositions, taken from https://fmm.univ-lille.fr

// clang-format off
// Classical Strassen algorithm
Tensor<int32_t> tensor_2x2x2 = {{2, 2, 2}, {
    {{{0, 1}, {3, 1}},  {{0, 1}, {3, 1}},  {{0, 1}, {3, 1}}},
    {{{1, 1}, {3, -1}}, {{2, 1}, {3, 1}},  {{0, 1}}},
    {{{2, 1}, {0, -1}}, {{0, 1}, {1, 1}},  {{3, 1}}},
    {{{1, 1}, {0, 1}},  {{3, 1}},          {{0, -1}, {1, 1}}},
    {{{0, 1}},          {{3, -1}, {1, 1}}, {{1, 1}, {3, 1}}},
    {{{3, 1}},          {{2, 1}, {0, -1}}, {{0, 1}, {2, 1}}},
    {{{3, 1}, {2, 1}},  {{0, 1}},          {{2, 1}, {3, -1}}}
}};

// Original paper: Hopcroft and Kerr "On Minimizing the Number of Multiplications Necessary for Matrix Multiplication", 1971
Tensor<int32_t> tensor_2x3x3 = {{2, 3, 3}, {
    {{{4, 1}},                            {{4, 1}, {1, -1}, {5, 1}},  {{1, -1}, {4, 1}}},
    {{{2, 1}},                            {{6, 1}, {8, 1}, {5, 1}},   {{2, 1}}},
    {{{5, 1}},                            {{7, 1}, {8, 1}, {2, 1}},   {{5, 1}}},
    {{{1, 1}, {4, 1}},                    {{3, -1}, {7, 1}, {4, 1}},  {{1, 1}}},
    {{{0, 1}, {3, 1}},                    {{6, 1}, {0, 1}, {1, -1}},  {{3, 1}}},
    {{{0, 1}},                            {{3, 1}, {0, -1}, {2, -1}}, {{0, -1}, {3, 1}}},
    {{{1, 1}, {0, 1}},                    {{3, 1}},                   {{0, 1}, {1, 1}}},
    {{{2, 1}, {1, -1}},                   {{5, 1}},                   {{1, 1}, {4, -1}, {2, -1}, {5, 1}}},
    {{{4, 1}, {3, 1}},                    {{1, 1}},                   {{3, 1}, {4, 1}}},
    {{{1, -1}, {4, -1}, {2, 1}, {5, 1}},  {{7, 1}},                   {{4, 1}, {5, -1}}},
    {{{1, -1}, {4, -1}, {2, 1}},          {{7, 1}, {5, -1}},          {{1, 1}, {4, -1}, {5, 1}}},
    {{{0, 1}, {3, 1}, {5, -1}},           {{6, -1}, {2, 1}},          {{0, -1}, {3, 1}, {2, 1}}},
    {{{0, 1}, {4, -1}},                   {{3, 1}, {1, -1}},          {{3, -1}, {1, -1}}},
    {{{0, -1}, {3, -1}, {2, 1}, {5, 1}},  {{6, 1}},                   {{0, 1}, {2, -1}}},
    {{{5, 1}, {3, -1}},                   {{2, 1}},                   {{0, -1}, {3, 1}, {2, 1}, {5, -1}}},
}};
// clang-format on
